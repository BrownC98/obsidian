---
created: 2025-05-29T23:51
updated: 2025-05-30T00:01
version: 1
---

# 5. ASSA 주요 데이터 모델 정의 v1.0

## 1. 데이터 모델 개요

### 1.1 모델 분류

- **사용자 관련 모델**: User, UserProfile, OAuth
- **게시물 관련 모델**: Post, Comment, Reply, PostFile
- **소셜 관계 모델**: Follow, Friend, BlockedUser
- **채팅 관련 모델**: ChatRoom, Message, ChatMember
- **영상통화 모델**: VideoRoom, VideoParticipant
- **알림 모델**: Notification, NotificationSetting
- **응답 모델**: ApiResponse, PaginationMeta

### 1.2 공통 규칙

- **필드명**: snake_case (DB/API), camelCase (Java/JSON)
- **날짜/시간**: ISO 8601 형식 (YYYY-MM-DDTHH:mm:ss.sssZ)
- **ID**: Long/BigInt 타입 사용
- **선택적 필드**: nullable 또는 optional로 표시
- **열거형**: 문자열 상수로 정의

## 2. 사용자 관련 모델

### 2.1 User (사용자)

```json
{
  "id": 1,
  "email": "user@example.com",
  "nickname": "사용자닉네임",
  "profile_image": "/storage/profiles/1.jpg",
  "introduction": "안녕하세요!",
  "email_verified_at": "2024-01-01T00:00:00.000Z",
  "created_at": "2024-01-01T00:00:00.000Z",
  "updated_at": "2024-01-01T00:00:00.000Z"
}
```

**필드 설명**:

- `id` (Long): 사용자 고유 식별자
- `email` (String): 로그인용 이메일 주소
- `nickname` (String): 화면 표시용 닉네임
- `profile_image` (String, nullable): 프로필 이미지 URL/경로
- `introduction` (String, nullable): 자기소개
- `email_verified_at` (DateTime, nullable): 이메일 인증 완료 시간
- `created_at` (DateTime): 계정 생성 시간
- `updated_at` (DateTime): 최종 수정 시간

### 2.2 UserProfile (사용자 프로필 확장)

```json
{
  "id": 1,
  "nickname": "사용자닉네임",
  "profile_image": "/storage/profiles/1.jpg",
  "introduction": "안녕하세요!",
  "created_at": "2024-01-01T00:00:00.000Z",
  "posts_count": 25,
  "followers_count": 100,
  "following_count": 50,
  "is_following": false,
  "friend_status": "none",
  "is_blocked": false,
  "is_online": true,
  "last_seen": "2024-01-01T12:00:00.000Z"
}
```

**추가 필드**:

- `posts_count` (Integer): 작성한 게시물 수
- `followers_count` (Integer): 팔로워 수
- `following_count` (Integer): 팔로잉 수
- `is_following` (Boolean): 현재 사용자가 이 사용자를 팔로우하는지
- `friend_status` (String): 친구 관계 상태 (none, pending, accepted, rejected)
- `is_blocked` (Boolean): 차단 여부
- `is_online` (Boolean): 온라인 상태
- `last_seen` (DateTime, nullable): 마지막 접속 시간

### 2.3 OAuth (소셜 로그인)

```json
{
  "id": 1,
  "user_id": 1,
  "provider": "kakao",
  "provider_id": "123456789",
  "provider_email": "user@kakao.com",
  "provider_nickname": "카카오닉네임",
  "provider_profile_image": "http://kakao.com/profile.jpg",
  "created_at": "2024-01-01T00:00:00.000Z"
}
```

**필드 설명**:

- `provider` (String): OAuth 제공자 (kakao, google, apple, etc.)
- `provider_id` (String): 제공자의 사용자 ID
- `provider_email` (String, nullable): 제공자에서 받은 이메일
- `provider_nickname` (String, nullable): 제공자에서 받은 닉네임
- `provider_profile_image` (String, nullable): 제공자 프로필 이미지

## 3. 게시물 관련 모델

### 3.1 Post (게시물)

```json
{
  "id": 1,
  "user_id": 1,
  "content": "게시물 내용입니다.",
  "view_count": 10,
  "created_at": "2024-01-01T00:00:00.000Z",
  "updated_at": "2024-01-01T00:00:00.000Z",
  "user": {
    "id": 1,
    "nickname": "작성자닉네임",
    "profile_image": "/storage/profiles/1.jpg"
  },
  "files": [
    {
      "id": 1,
      "file_path": "/storage/posts/image1.jpg",
      "file_name": "image1.jpg",
      "file_order": 0,
      "file_size": 1024000,
      "mime_type": "image/jpeg"
    }
  ],
  "likes_count": 5,
  "comments_count": 3,
  "is_liked": false,
  "is_editable": true
}
```

**필드 설명**:

- `content` (String): 게시물 내용
- `view_count` (Integer): 조회수
- `user` (UserProfile): 작성자 정보
- `files` (Array<PostFile>): 첨부 파일 목록
- `likes_count` (Integer): 좋아요 수
- `comments_count` (Integer): 댓글 수
- `is_liked` (Boolean): 현재 사용자의 좋아요 여부
- `is_editable` (Boolean): 현재 사용자가 수정 가능한지

### 3.2 PostFile (게시물 첨부파일)

```json
{
  "id": 1,
  "post_id": 1,
  "file_path": "/storage/posts/2024/01/abc123.jpg",
  "file_name": "original_name.jpg",
  "file_size": 1024000,
  "mime_type": "image/jpeg",
  "file_order": 0,
  "created_at": "2024-01-01T00:00:00.000Z"
}
```

**필드 설명**:

- `file_path` (String): 파일 저장 경로
- `file_name` (String): 원본 파일명
- `file_size` (Integer): 파일 크기 (bytes)
- `mime_type` (String): MIME 타입
- `file_order` (Integer): 파일 표시 순서

### 3.3 Comment (댓글)

```json
{
  "id": 1,
  "post_id": 1,
  "user_id": 1,
  "content": "댓글 내용입니다.",
  "is_edited": false,
  "created_at": "2024-01-01T00:00:00.000Z",
  "updated_at": "2024-01-01T00:00:00.000Z",
  "user": {
    "id": 1,
    "nickname": "댓글작성자",
    "profile_image": "/storage/profiles/1.jpg"
  },
  "likes_count": 2,
  "replies_count": 1,
  "is_liked": false,
  "is_editable": true
}
```

**필드 설명**:

- `is_edited` (Boolean): 수정 여부
- `replies_count` (Integer): 답글 수

### 3.4 Reply (답글)

```json
{
  "id": 1,
  "comment_id": 1,
  "user_id": 1,
  "content": "답글 내용입니다.",
  "mentioned_user_id": 2,
  "is_edited": false,
  "created_at": "2024-01-01T00:00:00.000Z",
  "updated_at": "2024-01-01T00:00:00.000Z",
  "user": {
    "id": 1,
    "nickname": "답글작성자",
    "profile_image": "/storage/profiles/1.jpg"
  },
  "mentioned_user": {
    "id": 2,
    "nickname": "멘션된사용자",
    "profile_image": "/storage/profiles/2.jpg"
  },
  "likes_count": 0,
  "is_liked": false,
  "is_editable": true
}
```

**필드 설명**:

- `mentioned_user_id` (Long, nullable): 멘션된 사용자 ID
- `mentioned_user` (UserProfile, nullable): 멘션된 사용자 정보

## 4. 소셜 관계 모델

### 4.1 Follow (팔로우 관계)

```json
{
  "id": 1,
  "follower_id": 1,
  "followed_id": 2,
  "created_at": "2024-01-01T00:00:00.000Z",
  "follower": {
    "id": 1,
    "nickname": "팔로워닉네임",
    "profile_image": "/storage/profiles/1.jpg"
  },
  "followed": {
    "id": 2,
    "nickname": "팔로우대상닉네임",
    "profile_image": "/storage/profiles/2.jpg"
  }
}
```

**필드 설명**:

- `follower_id` (Long): 팔로우하는 사용자 ID
- `followed_id` (Long): 팔로우받는 사용자 ID

### 4.2 Friend (친구 관계)

```json
{
  "id": 1,
  "requester_id": 1,
  "addressee_id": 2,
  "status": "accepted",
  "created_at": "2024-01-01T00:00:00.000Z",
  "updated_at": "2024-01-01T00:00:00.000Z",
  "requester": {
    "id": 1,
    "nickname": "신청자닉네임",
    "profile_image": "/storage/profiles/1.jpg"
  },
  "addressee": {
    "id": 2,
    "nickname": "수신자닉네임",
    "profile_image": "/storage/profiles/2.jpg"
  }
}
```

**필드 설명**:

- `requester_id` (Long): 친구 신청한 사용자 ID
- `addressee_id` (Long): 친구 신청받은 사용자 ID
- `status` (String): 친구 요청 상태 (pending, accepted, rejected)

### 4.3 BlockedUser (차단 관계)

```json
{
  "id": 1,
  "blocker_id": 1,
  "blocked_id": 2,
  "created_at": "2024-01-01T00:00:00.000Z",
  "blocker": {
    "id": 1,
    "nickname": "차단한사용자",
    "profile_image": "/storage/profiles/1.jpg"
  },
  "blocked": {
    "id": 2,
    "nickname": "차단된사용자",
    "profile_image": "/storage/profiles/2.jpg"
  }
}
```

**필드 설명**:

- `blocker_id` (Long): 차단한 사용자 ID
- `blocked_id` (Long): 차단된 사용자 ID

## 5. 채팅 관련 모델

### 5.1 ChatRoom (채팅방)

```json
{
  "id": 1,
  "name": "채팅방 이름",
  "description": "채팅방 설명",
  "host_user_id": 1,
  "is_open": false,
  "max_participants": 50,
  "participants_count": 3,
  "created_at": "2024-01-01T00:00:00.000Z",
  "updated_at": "2024-01-01T00:00:00.000Z",
  "host": {
    "id": 1,
    "nickname": "호스트닉네임",
    "profile_image": "/storage/profiles/1.jpg"
  },
  "last_message": {
    "id": 100,
    "content": "마지막 메시지",
    "message_type": "text",
    "created_at": "2024-01-01T12:00:00.000Z",
    "user": {
      "id": 2,
      "nickname": "발신자"
    }
  },
  "unread_count": 5,
  "my_role": "member"
}
```

**필드 설명**:

- `name` (String): 채팅방 이름
- `description` (String, nullable): 채팅방 설명
- `host_user_id` (Long): 호스트 사용자 ID
- `is_open` (Boolean): 오픈 채팅방 여부
- `max_participants` (Integer): 최대 참여자 수
- `participants_count` (Integer): 현재 참여자 수
- `last_message` (Message, nullable): 마지막 메시지
- `unread_count` (Integer): 읽지 않은 메시지 수
- `my_role` (String): 현재 사용자의 역할 (host, admin, member)

### 5.2 ChatMember (채팅방 멤버)

```json
{
  "id": 1,
  "user_id": 1,
  "chat_room_id": 1,
  "role": "member",
  "joined_at": "2024-01-01T00:00:00.000Z",
  "left_at": null,
  "is_active": true,
  "notification_enabled": true,
  "user": {
    "id": 1,
    "nickname": "멤버닉네임",
    "profile_image": "/storage/profiles/1.jpg",
    "is_online": true
  }
}
```

**필드 설명**:

- `role` (String): 채팅방에서의 역할 (host, admin, member)
- `joined_at` (DateTime): 참가 시간
- `left_at` (DateTime, nullable): 퇴장 시간
- `is_active` (Boolean): 활성 상태
- `notification_enabled` (Boolean): 알림 수신 설정

### 5.3 Message (메시지)

```json
{
  "id": 1001,
  "chat_room_id": 1,
  "user_id": 1,
  "content": "안녕하세요!",
  "message_type": "text",
  "file_path": null,
  "file_name": null,
  "is_edited": false,
  "created_at": "2024-01-01T12:00:00.000Z",
  "updated_at": "2024-01-01T12:00:00.000Z",
  "user": {
    "id": 1,
    "nickname": "발신자닉네임",
    "profile_image": "/storage/profiles/1.jpg"
  },
  "reply_to_message_id": null,
  "reply_to_message": null,
  "read_by": [
    {
      "user_id": 2,
      "nickname": "읽은사용자",
      "read_at": "2024-01-01T12:01:00.000Z"
    }
  ]
}
```

**필드 설명**:

- `message_type` (String): 메시지 타입 (text, image, system, file)
- `file_path` (String, nullable): 첨부 파일 경로
- `file_name` (String, nullable): 첨부 파일명
- `reply_to_message_id` (Long, nullable): 답장할 메시지 ID
- `reply_to_message` (Message, nullable): 답장할 메시지 정보
- `read_by` (Array): 메시지를 읽은 사용자 목록

## 6. 영상통화 모델

### 6.1 VideoRoom (영상회의 방)

```json
{
  "id": 200,
  "chat_room_id": 1,
  "video_room_name": "영상회의",
  "host_user_id": 1,
  "max_participants": 10,
  "participants_count": 2,
  "is_active": true,
  "created_at": "2024-01-01T12:00:00.000Z",
  "host": {
    "id": 1,
    "nickname": "호스트닉네임",
    "profile_image": "/storage/profiles/1.jpg"
  },
  "participants": [
    {
      "user_id": 1,
      "nickname": "호스트닉네임",
      "role": "host",
      "media_status": {
        "audio_enabled": true,
        "video_enabled": true
      },
      "joined_at": "2024-01-01T12:00:00.000Z"
    }
  ]
}
```

**필드 설명**:

- `chat_room_id` (Long): 연결된 채팅방 ID
- `video_room_name` (String): 영상회의 방 이름
- `is_active` (Boolean): 활성 상태

### 6.2 VideoParticipant (영상회의 참가자)

```json
{
  "user_id": 1,
  "video_room_id": 200,
  "nickname": "참가자닉네임",
  "profile_image": "/storage/profiles/1.jpg",
  "role": "participant",
  "media_status": {
    "audio_enabled": true,
    "video_enabled": false,
    "screen_sharing": false
  },
  "connection_status": "connected",
  "joined_at": "2024-01-01T12:00:00.000Z"
}
```

**필드 설명**:

- `role` (String): 영상회의에서의 역할 (host, participant)
- `media_status` (Object): 미디어 상태 정보
- `connection_status` (String): 연결 상태 (connected, connecting, disconnected)

## 7. 알림 모델

### 7.1 Notification (알림)

```json
{
  "id": 1,
  "user_id": 1,
  "type": "post_like",
  "title": "게시물 좋아요",
  "message": "사용자님이 회원님의 게시물을 좋아합니다",
  "data": {
    "post_id": 1,
    "user_id": 2,
    "user_nickname": "좋아요한사용자"
  },
  "is_read": false,
  "created_at": "2024-01-01T12:00:00.000Z",
  "read_at": null,
  "action_url": "/post/1"
}
```

**필드 설명**:

- `type` (String): 알림 유형 (post_like, comment, reply, follow, friend_request, message, etc.)
- `title` (String): 알림 제목
- `message` (String): 알림 내용
- `data` (Object): 추가 데이터 (JSON)
- `is_read` (Boolean): 읽음 여부
- `read_at` (DateTime, nullable): 읽은 시간
- `action_url` (String, nullable): 액션 URL

### 7.2 NotificationSetting (알림 설정)

```json
{
  "id": 1,
  "user_id": 1,
  "followed_user_id": 2,
  "post_notification": true,
  "comment_notification": true,
  "reply_notification": true,
  "like_notification": false,
  "message_notification": true,
  "video_call_notification": true,
  "created_at": "2024-01-01T00:00:00.000Z",
  "updated_at": "2024-01-01T12:00:00.000Z"
}
```

**필드 설명**:

- `followed_user_id` (Long): 팔로우한 사용자 ID (개별 설정용)
- `*_notification` (Boolean): 각 알림 유형별 수신 설정

## 8. 응답 모델

### 8.1 ApiResponse (API 응답)

```json
{
  "success": true,
  "message": "작업이 성공적으로 완료되었습니다",
  "data": {
    // 실제 데이터
  },
  "meta": {
    "current_page": 1,
    "per_page": 20,
    "total": 100,
    "last_page": 5
  },
  "errors": null,
  "error_code": null
}
```

**필드 설명**:

- `success` (Boolean): 성공 여부
- `message` (String): 응답 메시지
- `data` (Any): 실제 응답 데이터
- `meta` (PaginationMeta, nullable): 페이지네이션 정보
- `errors` (Object, nullable): 에러 정보
- `error_code` (String, nullable): 에러 코드

### 8.2 PaginationMeta (페이지네이션 메타)

```json
{
  "current_page": 1,
  "per_page": 20,
  "total": 100,
  "last_page": 5,
  "from": 1,
  "to": 20,
  "has_more": true
}
```

**필드 설명**:

- `current_page` (Integer): 현재 페이지
- `per_page` (Integer): 페이지당 항목 수
- `total` (Integer): 전체 항목 수
- `last_page` (Integer): 마지막 페이지
- `from` (Integer): 현재 페이지 시작 번호
- `to` (Integer): 현재 페이지 끝 번호
- `has_more` (Boolean): 다음 페이지 존재 여부

## 9. 검색 모델

### 9.1 SearchResult (통합 검색 결과)

```json
{
  "query": "검색어",
  "users": [
    {
      "id": 1,
      "nickname": "사용자닉네임",
      "profile_image": "/storage/profiles/1.jpg",
      "is_following": false,
      "match_type": "nickname"
    }
  ],
  "posts": [
    {
      "id": 1,
      "content": "게시물 내용 중 검색어가 포함된...",
      "created_at": "2024-01-01T12:00:00.000Z",
      "user": {
        "id": 1,
        "nickname": "작성자닉네임"
      },
      "likes_count": 5,
      "comments_count": 3,
      "match_type": "content"
    }
  ],
  "chat_rooms": [
    {
      "id": 1,
      "name": "채팅방 이름",
      "description": "채팅방 설명",
      "participants_count": 5,
      "is_open": true,
      "match_type": "name"
    }
  ],
  "total_count": {
    "users": 5,
    "posts": 10,
    "chat_rooms": 2
  }
}
```

**필드 설명**:

- `query` (String): 검색어
- `match_type` (String): 매칭 유형 (nickname, email, content, name, etc.)
- `total_count` (Object): 카테고리별 결과 수

## 10. 파일 모델

### 10.1 UploadedFile (업로드된 파일)

```json
{
  "original_name": "photo.jpg",
  "file_path": "/storage/uploads/2024/01/abc123.jpg",
  "file_name": "abc123.jpg",
  "file_size": 1024000,
  "mime_type": "image/jpeg",
  "file_type": "image",
  "upload_type": "post",
  "uploaded_at": "2024-01-01T12:00:00.000Z",
  "is_temporary": false
}
```

**필드 설명**:

- `original_name` (String): 원본 파일명
- `file_path` (String): 저장 경로
- `file_name` (String): 저장된 파일명
- `file_size` (Integer): 파일 크기 (bytes)
- `mime_type` (String): MIME 타입
- `file_type` (String): 파일 유형 (image, video, document, etc.)
- `upload_type` (String): 업로드 목적 (post, profile, message, etc.)
- `is_temporary` (Boolean): 임시 파일 여부

---

본 데이터 모델 정의는 ASSA 프로젝트의 모든 컴포넌트에서 사용하는 공통 데이터 구조를 정의하며, DB 스키마, API 응답, 소켓 메시지와 일관성을 유지해야 합니다.
