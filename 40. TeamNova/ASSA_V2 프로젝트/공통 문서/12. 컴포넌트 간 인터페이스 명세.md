---
created: 2025-05-30T00:25
updated: 2025-05-31T22:07
version: 1.1
tags:
  - ì¸í„°í˜ì´ìŠ¤
  - ì»´í¬ë„ŒíŠ¸_í†µì‹ 
  - ë°ì´í„°_ë™ê¸°í™”
  - í†µí•©_ëª…ì„¸
llm_keywords:
  - ì¸í„°í˜ì´ìŠ¤
  - í†µì‹ 
  - í”„ë¡œí† ì½œ
  - HTTP
  - Socket
  - API
  - ë™ê¸°í™”
  - ì—ëŸ¬ì²˜ë¦¬
context: ì»´í¬ë„ŒíŠ¸ ê°„ ìƒí˜¸ì‘ìš© ë° ë°ì´í„° êµí™˜ ë°©ì‹ ì •ì˜ - ì‹œìŠ¤í…œ í†µí•© í•µì‹¬ ëª…ì„¸
importance: high
audience:
  - all_llm
  - android_dev
  - php_backend
  - java_socket
relationships:
  - 03_APIëª…ì„¸
  - 04_ì†Œì¼“í”„ë¡œí† ì½œ
  - 05_ë°ì´í„°ëª¨ë¸
  - 02_DBìŠ¤í‚¤ë§ˆ
---

# ğŸ¤– ASSA ì»´í¬ë„ŒíŠ¸ ê°„ ì¸í„°í˜ì´ìŠ¤ ëª…ì„¸ v1.1

## ğŸ“Š LLM ë¹ ë¥¸ ì°¸ì¡° ì •ë³´

### ğŸ¯ **ë¬¸ì„œ ëª©ì **

- **ì£¼ ëª©ì **: ì»´í¬ë„ŒíŠ¸ ê°„ ìƒí˜¸ì‘ìš© ë° ë°ì´í„° êµí™˜ ë°©ì‹ ì •ì˜
- **LLM í™œìš©**: ì»´í¬ë„ŒíŠ¸ í†µí•©, ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„, ë°ì´í„° ë™ê¸°í™”, ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§ êµ¬í˜„
- **ì°¸ì¡° ì‹œì **: ì»´í¬ë„ŒíŠ¸ í†µí•©, ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„, ë°ì´í„° ë™ê¸°í™” ê°œë°œ ì‹œ

### ğŸ” **í•µì‹¬ ì¸í„°í˜ì´ìŠ¤ ì¹´í…Œê³ ë¦¬**

```
ğŸŒ HTTP í†µì‹ : Android â†” Laravel (REST API)
ğŸ”Œ Socket í†µì‹ : Android â†” Java Socket (ì‹¤ì‹œê°„)
ğŸ—„ï¸ DB ì—°ë™: Laravel â†” MySQL, Java Socket â†” MySQL
ğŸ”„ ë°ì´í„° ë™ê¸°í™”: ì»´í¬ë„ŒíŠ¸ ê°„ ì¼ê´€ì„± ë³´ì¥
âŒ ì—ëŸ¬ ì²˜ë¦¬: í†µí•© ì—ëŸ¬ í•¸ë“¤ë§ ì „ëµ
ğŸ“ íŒŒì¼ ì²˜ë¦¬: ì—…ë¡œë“œ/ë‹¤ìš´ë¡œë“œ í”„ë¡œí† ì½œ
```

### ğŸ“š **ê´€ë ¨ ë¬¸ì„œ ë§¤í•‘**

- **API ëª…ì„¸** â†’ [ğŸ“„ 03. PHP ë°±ì—”ë“œ API ëª…ì„¸](./03.%20PHP%20ë°±ì—”ë“œ%20API%20ëª…ì„¸.md)
- **ì†Œì¼“ í”„ë¡œí† ì½œ** â†’ [ğŸ“„ 04. Java ì‹¤ì‹œê°„ ì†Œì¼“ ì„œë²„ ë©”ì‹œì§€ í”„ë¡œí† ì½œ](./04.%20Java%20ì‹¤ì‹œê°„%20ì†Œì¼“%20ì„œë²„%20ë©”ì‹œì§€%20í”„ë¡œí† ì½œ.md)
- **ë°ì´í„° ëª¨ë¸** â†’ [ğŸ“„ 05. ì£¼ìš” ë°ì´í„° ëª¨ë¸ ì •ì˜](./05.%20ì£¼ìš”%20ë°ì´í„°%20ëª¨ë¸%20ì •ì˜.md)
- **DB ìŠ¤í‚¤ë§ˆ** â†’ [ğŸ“„ 02. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ](./02.%20ë°ì´í„°ë² ì´ìŠ¤%20ìŠ¤í‚¤ë§ˆ.md)

---

# 12. ASSA ì»´í¬ë„ŒíŠ¸ ê°„ ì¸í„°í˜ì´ìŠ¤ ëª…ì„¸ v1.1

## 1. ì¸í„°í˜ì´ìŠ¤ ê°œìš”

### 1.1 ì»´í¬ë„ŒíŠ¸ í†µì‹  êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     HTTP API     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     SQL     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Android Client â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Laravel Backend â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   MySQL DB      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                     â”‚
         â”‚ TCP Socket                          â”‚ HTTP API (ë‚´ë¶€)
         â”‚                                     â”‚
         â–¼                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     SQL/JDBC     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Java Socket     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   MySQL DB      â”‚
â”‚     Server      â”‚                  â”‚   (Direct)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ì¸í„°í˜ì´ìŠ¤ ìœ í˜•

- **HTTP REST API**: Android â†” Laravel
- **TCP Socket JSON**: Android â†” Java Socket Server
- **Database Access**: Laravel â†” MySQL, Java Socket Server â†” MySQL
- **Internal API**: Laravel â†” Java Socket Server (ì„ íƒì )

## 2. Android â†” Laravel ì¸í„°í˜ì´ìŠ¤

### 2.1 HTTP í—¤ë” í‘œì¤€

#### ê³µí†µ ìš”ì²­ í—¤ë”

```http
Content-Type: application/json
Accept: application/json
User-Agent: ASSA-Android/1.0
X-App-Version: 1.0.0
Authorization: Bearer {JWT_TOKEN}  # ì¸ì¦ í•„ìš” ì‹œ
```

#### ê³µí†µ ì‘ë‹µ í—¤ë”

```http
Content-Type: application/json; charset=utf-8
X-Response-Time: {ì‘ë‹µì‹œê°„ms}
X-Rate-Limit-Remaining: {ë‚¨ì€íšŸìˆ˜}
```

### 2.2 ì—ëŸ¬ ì²˜ë¦¬ í‘œì¤€

#### 4xx í´ë¼ì´ì–¸íŠ¸ ì—ëŸ¬

```json
{
  "success": false,
  "message": "ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",
  "error_code": "VALIDATION_ERROR",
  "errors": {
    "email": ["ì´ë©”ì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤"],
    "password": ["ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤"]
  },
  "timestamp": "2024-01-01T12:00:00.000Z"
}
```

#### 5xx ì„œë²„ ì—ëŸ¬

```json
{
  "success": false,
  "message": "ë‚´ë¶€ ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤",
  "error_code": "INTERNAL_SERVER_ERROR",
  "timestamp": "2024-01-01T12:00:00.000Z",
  "trace_id": "req_abc123xyz"
}
```

### 2.3 í˜ì´ì§€ë„¤ì´ì…˜ í‘œì¤€

#### ìš”ì²­ íŒŒë¼ë¯¸í„°

```http
GET /api/posts?page=1&per_page=20&sort=created_at&order=desc
```

#### ì‘ë‹µ í˜•ì‹

```json
{
  "success": true,
  "data": [...],
  "meta": {
    "current_page": 1,
    "per_page": 20,
    "total": 150,
    "last_page": 8,
    "from": 1,
    "to": 20,
    "has_more": true
  },
  "links": {
    "first": "/api/posts?page=1",
    "last": "/api/posts?page=8",
    "prev": null,
    "next": "/api/posts?page=2"
  }
}
```

### 2.4 íŒŒì¼ ì—…ë¡œë“œ ì¸í„°í˜ì´ìŠ¤

#### í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ

```http
POST /api/user/upload-profile-image
Content-Type: multipart/form-data

file: {ì´ë¯¸ì§€íŒŒì¼}
```

#### ì‘ë‹µ

```json
{
  "success": true,
  "message": "í”„ë¡œí•„ ì´ë¯¸ì§€ê°€ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤",
  "data": {
    "file_path": "/storage/profiles/user_123_20240101.jpg",
    "file_size": 1024000,
    "mime_type": "image/jpeg"
  }
}
```

## 3. Android â†” Java Socket Server ì¸í„°í˜ì´ìŠ¤

### 3.1 ì—°ê²° ì´ˆê¸°í™” í”„ë¡œì„¸ìŠ¤

#### 1ë‹¨ê³„: Socket ì—°ê²°

```java
// Android ì—°ê²° ì½”ë“œ
Socket socket = new Socket("10.0.2.2", 12345);
PrintWriter out = new PrintWriter(socket.getOutputStream(), true);
BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
```

#### 2ë‹¨ê³„: ì¸ì¦ ë©”ì‹œì§€

```json
{
  "action": "CONNECT",
  "data": {
    "jwt_token": "eyJ0eXAiOiJKV1QiLCJhbGc...",
    "device_info": {
      "platform": "android",
      "app_version": "1.0.0",
      "device_id": "android_device_123"
    }
  },
  "timestamp": "2024-01-01T12:00:00.000Z",
  "seq_id": "connect_001"
}
```

#### 3ë‹¨ê³„: ì¸ì¦ ì‘ë‹µ

```json
{
  "action": "CONNECT_RESPONSE",
  "success": true,
  "message": "ì¸ì¦ ì„±ê³µ",
  "data": {
    "user_id": 123,
    "session_id": "session_abc123",
    "server_time": "2024-01-01T12:00:00.000Z"
  },
  "timestamp": "2024-01-01T12:00:00.000Z",
  "seq_id": "connect_001"
}
```

### 3.2 ë©”ì‹œì§€ ì†¡ìˆ˜ì‹  í”„ë¡œí† ì½œ

#### ì±„íŒ… ë©”ì‹œì§€ ì „ì†¡

```json
{
  "action": "SEND_MESSAGE",
  "data": {
    "chatroom_id": 1,
    "content": "ì•ˆë…•í•˜ì„¸ìš”!",
    "message_type": "text"
  },
  "timestamp": "2024-01-01T12:05:00.000Z",
  "seq_id": "msg_001",
  "user_id": 123
}
```

#### ë©”ì‹œì§€ ìˆ˜ì‹  (ë¸Œë¡œë“œìºìŠ¤íŠ¸)

```json
{
  "action": "MESSAGE_RECEIVED",
  "data": {
    "message_id": 1001,
    "chatroom_id": 1,
    "user_id": 456,
    "content": "ì•ˆë…•í•˜ì„¸ìš”! ë°˜ê°€ì›Œìš”!",
    "message_type": "text",
    "user": {
      "id": 456,
      "nickname": "Alice_Kim",
      "profile_image": "/storage/profiles/alice.jpg"
    },
    "created_at": "2024-01-01T12:05:30.000Z"
  },
  "timestamp": "2024-01-01T12:05:30.000Z",
  "seq_id": "broadcast_001"
}
```

### 3.3 ì—°ê²° ìƒíƒœ ê´€ë¦¬

#### í•˜íŠ¸ë¹„íŠ¸ (Keep-Alive)

```json
// í´ë¼ì´ì–¸íŠ¸ â†’ ì„œë²„ (30ì´ˆë§ˆë‹¤)
{
  "action": "PING",
  "timestamp": "2024-01-01T12:10:00.000Z",
  "seq_id": "ping_001",
  "user_id": 123
}

// ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸
{
  "action": "PONG",
  "timestamp": "2024-01-01T12:10:00.000Z",
  "seq_id": "ping_001"
}
```

#### ì—°ê²° í•´ì œ

```json
{
  "action": "DISCONNECT",
  "data": {
    "reason": "user_logout"
  },
  "timestamp": "2024-01-01T12:30:00.000Z",
  "seq_id": "disconnect_001",
  "user_id": 123
}
```

## 4. Laravel â†” MySQL ì¸í„°í˜ì´ìŠ¤

### 4.1 ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì •

#### config/database.php

```php
'mysql' => [
    'driver' => 'mysql',
    'host' => env('DB_HOST', '127.0.0.1'),
    'port' => env('DB_PORT', '3306'),
    'database' => env('DB_DATABASE', 'assa_db'),
    'username' => env('DB_USERNAME', 'assa_user'),
    'password' => env('DB_PASSWORD', 'assa_password'),
    'charset' => 'utf8mb4',
    'collation' => 'utf8mb4_unicode_ci',
    'options' => [
        PDO::ATTR_PERSISTENT => true,
        PDO::ATTR_TIMEOUT => 30,
    ]
],
```

### 4.2 Eloquent ëª¨ë¸ ê´€ê³„

#### User ëª¨ë¸ ê´€ê³„

```php
class User extends Model
{
    // ì‚¬ìš©ìê°€ ì‘ì„±í•œ ê²Œì‹œë¬¼
    public function posts()
    {
        return $this->hasMany(Post::class);
    }

    // ì‚¬ìš©ìê°€ íŒ”ë¡œìš°í•˜ëŠ” ì‚¬ëŒë“¤
    public function following()
    {
        return $this->belongsToMany(User::class, 'follows', 'follower_id', 'following_id');
    }

    // ì‚¬ìš©ìë¥¼ íŒ”ë¡œìš°í•˜ëŠ” ì‚¬ëŒë“¤
    public function followers()
    {
        return $this->belongsToMany(User::class, 'follows', 'following_id', 'follower_id');
    }

    // ì°¸ì—¬ ì¤‘ì¸ ì±„íŒ…ë°©
    public function chatRooms()
    {
        return $this->belongsToMany(ChatRoom::class, 'user_chatroom_map', 'user_id', 'chatroom_id');
    }
}
```

### 4.3 íŠ¸ëœì­ì…˜ ì²˜ë¦¬

#### ê²Œì‹œë¬¼ ì‘ì„± ì‹œ íŠ¸ëœì­ì…˜

```php
DB::transaction(function () use ($data) {
    // 1. ê²Œì‹œë¬¼ ìƒì„±
    $post = Post::create($data);

    // 2. íŒŒì¼ ì²¨ë¶€ (ìˆëŠ” ê²½ìš°)
    if (!empty($data['files'])) {
        foreach ($data['files'] as $file) {
            $post->files()->create($file);
        }
    }

    // 3. íŒ”ë¡œì›Œë“¤ì—ê²Œ ì•Œë¦¼ ìƒì„±
    $followers = $post->user->followers;
    foreach ($followers as $follower) {
        Notification::create([
            'user_id' => $follower->id,
            'type' => 'new_post',
            'data' => ['post_id' => $post->id]
        ]);
    }

    return $post;
});
```

## 5. Java Socket Server â†” MySQL ì¸í„°í˜ì´ìŠ¤

### 5.1 JDBC ì—°ê²° ê´€ë¦¬

#### DatabaseConnection.java

```java
public class DatabaseConnection {
    private static final String URL = "jdbc:mysql://localhost:3306/assa_db";
    private static final String USERNAME = "assa_user";
    private static final String PASSWORD = "assa_password";
    private static HikariDataSource dataSource;

    static {
        HikariConfig config = new HikariConfig();
        config.setJdbcUrl(URL);
        config.setUsername(USERNAME);
        config.setPassword(PASSWORD);
        config.setMaximumPoolSize(20);
        config.setConnectionTimeout(30000);
        config.setIdleTimeout(600000);
        config.setMaxLifetime(1800000);

        dataSource = new HikariDataSource(config);
    }

    public static Connection getConnection() throws SQLException {
        return dataSource.getConnection();
    }
}
```

### 5.2 ë°ì´í„° ì ‘ê·¼ ê°ì²´ (DAO)

#### MessageDAO.java

```java
public class MessageDAO {

    public boolean saveMessage(Message message) {
        String sql = "INSERT INTO messages (chatroom_id, user_id, content, message_type, created_at) VALUES (?, ?, ?, ?, ?)";

        try (Connection conn = DatabaseConnection.getConnection();
             PreparedStatement stmt = conn.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS)) {

            stmt.setLong(1, message.getChatroomId());
            stmt.setLong(2, message.getUserId());
            stmt.setString(3, message.getContent());
            stmt.setString(4, message.getMessageType());
            stmt.setTimestamp(5, Timestamp.valueOf(message.getCreatedAt()));

            int result = stmt.executeUpdate();

            if (result > 0) {
                ResultSet rs = stmt.getGeneratedKeys();
                if (rs.next()) {
                    message.setId(rs.getLong(1));
                }
                return true;
            }

        } catch (SQLException e) {
            logger.error("ë©”ì‹œì§€ ì €ì¥ ì‹¤íŒ¨: " + e.getMessage(), e);
        }

        return false;
    }

    public List<Message> getRecentMessages(long chatroomId, int limit) {
        String sql = "SELECT m.*, u.nickname, u.profile_image " +
                    "FROM messages m " +
                    "JOIN users u ON m.user_id = u.id " +
                    "WHERE m.chatroom_id = ? " +
                    "ORDER BY m.created_at DESC LIMIT ?";

        List<Message> messages = new ArrayList<>();

        try (Connection conn = DatabaseConnection.getConnection();
             PreparedStatement stmt = conn.prepareStatement(sql)) {

            stmt.setLong(1, chatroomId);
            stmt.setInt(2, limit);

            ResultSet rs = stmt.executeQuery();
            while (rs.next()) {
                Message message = new Message();
                message.setId(rs.getLong("id"));
                message.setChatroomId(rs.getLong("chatroom_id"));
                message.setUserId(rs.getLong("user_id"));
                message.setContent(rs.getString("content"));
                message.setMessageType(rs.getString("message_type"));
                message.setCreatedAt(rs.getTimestamp("created_at").toLocalDateTime());

                // ì‚¬ìš©ì ì •ë³´ ì„¤ì •
                message.setUserNickname(rs.getString("nickname"));
                message.setUserProfileImage(rs.getString("profile_image"));

                messages.add(message);
            }

        } catch (SQLException e) {
            logger.error("ë©”ì‹œì§€ ì¡°íšŒ ì‹¤íŒ¨: " + e.getMessage(), e);
        }

        return messages;
    }
}
```

## 6. Laravel â†” Java Socket Server ì¸í„°í˜ì´ìŠ¤ (ì„ íƒì )

### 6.1 ë‚´ë¶€ API í†µì‹ 

#### Laravelì—ì„œ Socket Serverë¡œ ì•Œë¦¼

```php
// app/Services/SocketNotificationService.php
class SocketNotificationService
{
    private $socketServerUrl = 'http://localhost:8080/internal';

    public function notifyNewMessage($chatroomId, $messageData)
    {
        $payload = [
            'action' => 'BROADCAST_MESSAGE',
            'chatroom_id' => $chatroomId,
            'message' => $messageData
        ];

        $client = new GuzzleHttp\Client();
        try {
            $response = $client->post($this->socketServerUrl . '/broadcast', [
                'json' => $payload,
                'headers' => [
                    'Authorization' => 'Bearer ' . env('INTERNAL_API_TOKEN'),
                    'Content-Type' => 'application/json'
                ]
            ]);

            return $response->getStatusCode() === 200;
        } catch (Exception $e) {
            Log::error('Socket ì„œë²„ í†µì‹  ì‹¤íŒ¨: ' . $e->getMessage());
            return false;
        }
    }
}
```

### 6.2 Socket Server HTTP API

#### Java Socket Server ë‚´ë¶€ API

```java
@RestController
@RequestMapping("/internal")
public class InternalApiController {

    @PostMapping("/broadcast")
    public ResponseEntity<String> broadcastMessage(@RequestBody BroadcastRequest request) {
        try {
            // ì¸ì¦ í™•ì¸
            if (!isValidInternalToken(request.getToken())) {
                return ResponseEntity.status(401).body("Unauthorized");
            }

            // ë©”ì‹œì§€ ë¸Œë¡œë“œìºìŠ¤íŠ¸
            socketManager.broadcastToRoom(request.getChatroomId(), request.getMessage());

            return ResponseEntity.ok("Success");
        } catch (Exception e) {
            logger.error("ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì‹¤íŒ¨: " + e.getMessage(), e);
            return ResponseEntity.status(500).body("Internal Server Error");
        }
    }
}
```

## 7. ë°ì´í„° ë™ê¸°í™” ì „ëµ

### 7.1 ì‹¤ì‹œê°„ ë°ì´í„° ì¼ê´€ì„±

#### ì±„íŒ… ë©”ì‹œì§€ ë™ê¸°í™”

1. **Android** â†’ **Socket Server**: ë©”ì‹œì§€ ì „ì†¡
2. **Socket Server** â†’ **MySQL**: ë©”ì‹œì§€ ì €ì¥
3. **Socket Server** â†’ **Android (All)**: ë©”ì‹œì§€ ë¸Œë¡œë“œìºìŠ¤íŠ¸
4. **Laravel** â†’ **MySQL**: ì½ê¸° ì „ìš© ì ‘ê·¼ (API ìš”ì²­ ì‹œ)

#### ì‚¬ìš©ì ì˜¨ë¼ì¸ ìƒíƒœ ë™ê¸°í™”

1. **Socket Server**: ì‹¤ì‹œê°„ ìƒíƒœ ê´€ë¦¬ (ë©”ëª¨ë¦¬)
2. **Laravel**: ì£¼ê¸°ì  ì—…ë°ì´íŠ¸ (5ë¶„ë§ˆë‹¤)
3. **MySQL**: `users.last_seen` ì»¬ëŸ¼ ì—…ë°ì´íŠ¸

### 7.2 ìºì‹œ ì „ëµ

#### Laravel ìºì‹œ ì‚¬ìš©

```php
// ì‚¬ìš©ì í”„ë¡œí•„ ìºì‹± (60ë¶„)
$user = Cache::remember("user.profile.{$userId}", 3600, function () use ($userId) {
    return User::with(['followers', 'following'])->find($userId);
});

// ì¸ê¸° ê²Œì‹œë¬¼ ìºì‹± (10ë¶„)
$popularPosts = Cache::remember('posts.popular', 600, function () {
    return Post::withCount('likes')
               ->orderBy('likes_count', 'desc')
               ->limit(20)
               ->get();
});
```

## 8. ì—ëŸ¬ ì²˜ë¦¬ ë° ë³µêµ¬

### 8.1 ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ ì²˜ë¦¬

#### Android ì¬ì—°ê²° ë¡œì§

```java
public class SocketManager {
    private static final int MAX_RETRY_COUNT = 3;
    private static final long RETRY_DELAY_MS = 5000;

    public void handleConnectionLost() {
        int retryCount = 0;

        while (retryCount < MAX_RETRY_COUNT) {
            try {
                Thread.sleep(RETRY_DELAY_MS * (retryCount + 1));

                if (reconnect()) {
                    Log.i("SocketManager", "ì¬ì—°ê²° ì„±ê³µ");
                    return;
                }

                retryCount++;
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
                break;
            }
        }

        // ì¬ì—°ê²° ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼
        notifyConnectionFailed();
    }
}
```

### 8.2 ë°ì´í„°ë² ì´ìŠ¤ ì¥ì•  ì²˜ë¦¬

#### Connection Pool ëª¨ë‹ˆí„°ë§

```java
public class DatabaseHealthChecker {

    @Scheduled(fixedRate = 30000) // 30ì´ˆë§ˆë‹¤
    public void checkDatabaseHealth() {
        try (Connection conn = DatabaseConnection.getConnection()) {
            PreparedStatement stmt = conn.prepareStatement("SELECT 1");
            ResultSet rs = stmt.executeQuery();

            if (rs.next()) {
                logger.debug("ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœ ì •ìƒ");
            }
        } catch (SQLException e) {
            logger.error("ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨: " + e.getMessage());

            // ì•Œë¦¼ ë˜ëŠ” ë³µêµ¬ ë¡œì§
            notifyDatabaseFailure();
        }
    }
}
```

## 9. ì„±ëŠ¥ ìµœì í™”

### 9.1 ìš”ì²­ ì œí•œ (Rate Limiting)

#### Laravel API ì œí•œ

```php
// routes/api.php
Route::middleware(['auth:api', 'throttle:60,1'])->group(function () {
    Route::apiResource('posts', PostController::class);
});

Route::middleware(['auth:api', 'throttle:30,1'])->group(function () {
    Route::post('posts/{post}/like', [PostController::class, 'toggleLike']);
});
```

#### Socket Server ë©”ì‹œì§€ ì œí•œ

```java
public class MessageRateLimiter {
    private Map<Long, Bucket> userBuckets = new ConcurrentHashMap<>();

    public boolean isAllowed(long userId) {
        Bucket bucket = userBuckets.computeIfAbsent(userId, k ->
            Bucket4j.builder()
                   .addLimit(Bandwidth.classic(10, Refill.intervally(10, Duration.ofMinutes(1))))
                   .build());

        return bucket.tryConsume(1);
    }
}
```

### 9.2 ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”

#### ì¸ë±ìŠ¤ í™œìš©

```sql
-- ìì£¼ ì‚¬ìš©ë˜ëŠ” ì¿¼ë¦¬ ìµœì í™”
CREATE INDEX idx_posts_user_created ON posts(user_id, created_at DESC);
CREATE INDEX idx_messages_chatroom_created ON messages(chatroom_id, created_at DESC);
CREATE INDEX idx_follows_composite ON follows(follower_id, following_id);
```

---

ğŸ’¡ **ì°¸ê³ **: ì´ ì¸í„°í˜ì´ìŠ¤ ëª…ì„¸ë¥¼ ë”°ë¼ êµ¬í˜„í•˜ë©´ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ì•ˆì •ì ìœ¼ë¡œ í†µì‹ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
